(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0baadb"],{"37de":function(e,t,o){"use strict";o.r(t);var n=o("7a23"),a={class:"container"},c={class:"text-end mt-4"},l={class:"table mt-4"},i=Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("th",null,"名稱"),Object(n["createElementVNode"])("th",null,"折扣百分比"),Object(n["createElementVNode"])("th",null,"到期日"),Object(n["createElementVNode"])("th",null,"是否啟用"),Object(n["createElementVNode"])("th",null,"編輯")])],-1),d={key:0,class:"text-success"},s={key:1,class:"text-muted"},r={class:"btn-group"},u=["onClick"],p=["onClick"];function b(e,t,o,b,m,j){var h=Object(n["resolveComponent"])("Loading"),O=Object(n["resolveComponent"])("CouponModal"),v=Object(n["resolveComponent"])("DeleteModal"),f=Object(n["resolveComponent"])("Pagination");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",a,[Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(h,{active:m.isLoading,"z-index":1060},null,8,["active"]),Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=function(e){return j.openCouponModal(!0)})}," 建立新的優惠券 ")]),Object(n["createElementVNode"])("table",l,[i,Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(m.coupons,(function(t,o){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:o},[Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(t.title),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(t.percent)+"%",1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(e.$filters.date(t.due_date)),1),Object(n["createElementVNode"])("td",null,[1===t.is_enabled?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",d,"啟用")):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",s,"未啟用"))]),Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("div",r,[Object(n["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm",onClick:function(e){return j.openCouponModal(!1,t)}}," 編輯 ",8,u),Object(n["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm ms-1",onClick:function(e){return j.openDeleteCouponModal(t)}}," 刪除 ",8,p)])])])})),128))])]),Object(n["createVNode"])(O,{coupon:m.tempCoupon,"is-new":m.isNew,ref:"couponModal",onUpdateCoupon:j.updateCoupon},null,8,["coupon","is-new","onUpdateCoupon"]),Object(n["createVNode"])(v,{item:m.tempCoupon,ref:"deleteModal",onDeleteItem:j.deleteCoupon},null,8,["item","onDeleteItem"]),Object(n["createVNode"])(f,{pages:m.pagination,onEmitPages:j.getCoupons},null,8,["pages","onEmitPages"])])])}var m=o("5530"),j=(o("99af"),o("ec05")),h={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},O={class:"modal-dialog",role:"document"},v={class:"modal-content"},f={class:"modal-header"},N={class:"modal-title",id:"exampleModalLabel"},E={key:0},V={key:1},C=Object(n["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),g={class:"modal-body"},k={class:"mb-3"},M=Object(n["createElementVNode"])("label",{for:"title"},"標題",-1),y={class:"mb-3"},w=Object(n["createElementVNode"])("label",{for:"coupon_code"},"優惠碼",-1),D={class:"mb-3"},x=Object(n["createElementVNode"])("label",{for:"due_date"},"到期日",-1),B={class:"mb-3"},L=Object(n["createElementVNode"])("label",{for:"price"},"折扣百分比",-1),$={class:"mb-3"},_={class:"form-check"},S=Object(n["createElementVNode"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),P={class:"modal-footer"},U=Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function T(e,t,o,a,c,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",h,[Object(n["createElementVNode"])("div",O,[Object(n["createElementVNode"])("div",v,[Object(n["createElementVNode"])("div",f,[Object(n["createElementVNode"])("h5",N,[o.isNew?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",E,"新增優惠卷")):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",V,"編輯優惠卷"))]),C]),Object(n["createElementVNode"])("div",g,[Object(n["createElementVNode"])("div",k,[M,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.tempCoupon.title=e}),placeholder:"請輸入標題"},null,512),[[n["vModelText"],c.tempCoupon.title]])]),Object(n["createElementVNode"])("div",y,[w,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.tempCoupon.code=e}),placeholder:"請輸入優惠碼"},null,512),[[n["vModelText"],c.tempCoupon.code]])]),Object(n["createElementVNode"])("div",D,[x,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.dueDate=e})},null,512),[[n["vModelText"],c.dueDate]])]),Object(n["createElementVNode"])("div",B,[L,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.tempCoupon.percent=e}),placeholder:"請輸入折扣百分比"},null,512),[[n["vModelText"],c.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["createElementVNode"])("div",$,[Object(n["createElementVNode"])("div",_,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.tempCoupon.is_enabled=e}),id:"is_enabled"},null,512),[[n["vModelCheckbox"],c.tempCoupon.is_enabled]]),S])])]),Object(n["createElementVNode"])("div",P,[U,Object(n["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=function(t){return e.$emit("update-coupon",c.tempCoupon)})},Object(n["toDisplayString"])(o.isNew?"新增優惠卷":"更新優惠券"),1)])])])],512)}var I=o("3835"),J=(o("ac1f"),o("1276"),o("e0ae")),z={props:{coupon:{type:Object,default:function(){return{}}},isNew:{type:Boolean,default:!1}},data:function(){return{tempCoupon:{},dueDate:"",modal:""}},mixins:[J["a"]],watch:{coupon:function(){this.tempCoupon=this.coupon;var e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T"),t=Object(I["a"])(e,1);this.dueDate=t[0]},dueDate:function(){this.tempCoupon.due_date=Math.floor(new Date(this.dueDate)/1e3)}}},F=o("6b0d"),q=o.n(F);const A=q()(z,[["render",T]]);var G=A,H=o("1799"),K={data:function(){return{coupons:[],tempCoupon:{},isNew:!1,currentPage:1,pagination:{},isLoading:!1}},methods:{getCoupons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0,this.currentPage=t;var o="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("jasper07301","/admin/coupons?page=").concat(t);this.$http.get(o).then((function(t){e.coupons=t.data.coupons,e.pagination=t.data.pagination,e.isLoading=!1})).catch((function(t){e.isLoading=!1,e.$httpMessageState(t.response,"優惠券")}))},openCouponModal:function(e,t){this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon=Object(m["a"])({},t);var o=this.$refs.couponModal;o.openModal()},openDeleteCouponModal:function(e){this.tempCoupon=Object(m["a"])({},e);var t=this.$refs.deleteModal;t.openModal()},updateCoupon:function(e){var t=this;this.isLoading=!0;var o="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("jasper07301","/admin/coupon"),n="post",a=e;this.isNew||(n="put",o="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("jasper07301","/admin/coupon/").concat(this.tempCoupon.id),a=this.tempCoupon),this.$http[n](o,{data:a}).then((function(e){t.isLoading=!1,t.isNew?t.$httpMessageState(e,"新增優惠券"):t.$httpMessageState(e,"更新優惠券"),t.getCoupons(t.currentPage);var o=t.$refs.couponModal;o.hideModal()})).catch((function(e){t.isLoading=!1,t.$httpMessageState(e.response,"新增優惠券")}))},deleteCoupon:function(){var e=this;this.isLoading=!0;var t="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("jasper07301","/admin/coupon/").concat(this.tempCoupon.id);this.$http.delete(t).then((function(t){e.isLoading=!1,e.$httpMessageState(t,"刪除"),e.getCoupons(e.currentPage);var o=e.$refs.deleteModal;o.hideModal()})).catch((function(t){e.isLoading=!1,e.$httpMessageState(t.response,"刪除")}))}},components:{DeleteModal:j["a"],CouponModal:G,Pagination:H["a"]},mounted:function(){this.getCoupons()}};const Q=q()(K,[["render",b]]);t["default"]=Q}}]);
//# sourceMappingURL=chunk-2d0baadb.7c5effd9.js.map